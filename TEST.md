# 🧪 快速測試指南

如果你想快速測試系統是否正常運作，請按照以下步驟：

## 📋 測試前檢查清單

- [ ] 已安裝 Node.js
- [ ] 已執行 `npm install`
- [ ] 已設定 `.env` 檔案（至少要有 LINE 的設定）
- [ ] 已啟動伺服器 `npm start`
- [ ] 已啟動 ngrok `ngrok http 3000`
- [ ] 已在 LINE Developers Console 設定 Webhook URL

## 🚀 測試流程

### Test 1: 伺服器健康檢查

開啟瀏覽器，前往：
```
http://localhost:3000
```

應該會看到：
```json
{
  "status": "LINE 打卡系統運行中",
  "timestamp": "2026-02-14T12:00:00.000Z"
}
```

✅ 如果看到這個，表示伺服器正常運作！

---

### Test 2: Webhook 測試

在 LINE Developers Console 點選「Verify」測試 Webhook。

應該會顯示：**Success**

✅ 如果成功，表示 LINE 可以正常連接到你的伺服器！

---

### Test 3: LINE Bot 互動測試

#### 步驟 1: 查看說明
發送訊息：`說明`

預期回應：
```
🤖 LINE 打卡系統使用說明

📝 可用指令：
• 註冊 [姓名] - 員工註冊
• 上班 - 上班打卡
• 下班 - 下班打卡
• 查詢 - 查詢今日紀錄
• 說明 - 顯示此說明
```

---

#### 步驟 2: 註冊員工
發送訊息：`註冊 測試員工`

預期回應：
```
✅ 註冊成功！

員工姓名：測試員工

您現在可以使用以下指令：
• 上班 - 上班打卡
• 下班 - 下班打卡
• 查詢 - 查詢今日紀錄
```

---

#### 步驟 3: 上班打卡
發送訊息：`上班`

預期回應：
```
✅ 上班打卡成功！

員工：測試員工
時間：14:30:25
```

---

#### 步驟 4: 下班打卡
發送訊息：`下班`

預期回應：
```
✅ 下班打卡成功！

員工：測試員工
時間：18:30:45
```

---

#### 步驟 5: 查詢紀錄
發送訊息：`查詢`

預期回應：
```
📋 測試員工 今日打卡紀錄：

1. 上班 - 14:30:25
2. 下班 - 18:30:45
```

---

### Test 4: Google Sheets 整合測試

1. 打開你的 Google Sheet
2. 應該會看到「打卡紀錄」工作表中有資料：

| 日期 | 時間 | 員工姓名 | 類型 | LINE User ID | 完整時間戳記 |
|------|------|---------|------|-------------|-------------|
| 2026-02-14 | 14:30:25 | 測試員工 | 上班 | U1234... | 2026-02-14T06:30:25.000Z |
| 2026-02-14 | 18:30:45 | 測試員工 | 下班 | U1234... | 2026-02-14T10:30:45.000Z |

✅ 如果看到資料，表示 Google Sheets 整合成功！

---

## ⚠️ 常見錯誤

### 錯誤 1: "系統錯誤，請稍後再試"

**原因**：
- LINE Bot 設定錯誤
- `.env` 檔案中的 Token 或 Secret 不正確

**解決方法**：
1. 檢查終端機的錯誤訊息
2. 確認 `.env` 的設定正確
3. 重新啟動伺服器

---

### 錯誤 2: Google Sheets 沒有資料

**情況 1**：終端機顯示「⚠️ Google Sheets 未設定，跳過儲存」

**原因**：
- 沒有設定 Google Sheets 憑證
- `google-credentials.json` 不存在

**解決方法**：
- 這不會影響打卡功能，資料仍會儲存在伺服器記憶體中
- 如需 Google Sheets 功能，請完成 SETUP_GUIDE.md 的 Step 2

**情況 2**：終端機顯示「❌ Google Sheets 儲存失敗」

**原因**：
- Google Sheet 沒有共用給服務帳戶
- Sheet ID 錯誤
- 工作表名稱不是「打卡紀錄」

**解決方法**：
- 檢查 Google Sheet 共用設定
- 確認工作表名稱為「打卡紀錄」

---

### 錯誤 3: Bot 完全沒有回應

**檢查項目**：
1. ✅ 伺服器是否正在運行？
2. ✅ ngrok 是否正在運行？
3. ✅ Webhook URL 是否正確設定？
4. ✅ LINE 後台「Auto-response messages」是否已停用？

---

## 📊 檢視伺服器 Log

如果有問題，請查看終端機的 log 輸出，會顯示：

```
收到訊息: 上班 (來自: U1234567890abcdef)
✅ 打卡成功: 測試員工 - in - 14:30:25
✅ 已儲存到 Google Sheets
```

這些 log 可以幫助你了解系統運作狀況和錯誤原因。

---

## 🎯 測試完成檢查清單

完成所有測試後，確認：

- [ ] 伺服器可以正常啟動
- [ ] Webhook 驗證成功
- [ ] 可以註冊員工
- [ ] 可以上班打卡
- [ ] 可以下班打卡
- [ ] 可以查詢紀錄
- [ ] Google Sheets 有收到資料（如已設定）

全部打勾表示系統運作正常！ 🎉
